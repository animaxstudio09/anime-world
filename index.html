<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ANIMAX | Premium Streaming</title>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root { --primary: #00d2ff; --bg: #0f0f0f; --card-bg: #1a1a1a; --gold: #ffd700; }
        body { font-family: 'Poppins', sans-serif; background: var(--bg); color: #fff; margin: 0; padding-bottom: 50px; overflow-x: hidden; }

        /* Navbar */
        nav { display: flex; justify-content: space-between; align-items: center; padding: 12px 5%; background: rgba(0,0,0,0.9); backdrop-filter: blur(10px); position: fixed; top: 0; left: 0; right: 0; z-index: 1000; border-bottom: 1px solid #222; }
        .logo-img { height: 40px; cursor: pointer; }
        .buy-btn { background: transparent; border: 2px solid var(--gold); color: var(--gold); padding: 6px 15px; border-radius: 20px; font-weight: bold; font-size: 12px; cursor: pointer; transition: 0.3s; }
        .buy-btn:hover { background: var(--gold); color: #000; }

        /* Hero Slider */
        .hero-container { margin-top: 70px; position: relative; width: 90%; margin-left: 5%; height: 300px; border-radius: 20px; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .hero-banner { width: 100%; height: 100%; background-size: cover; background-position: center; display: flex; flex-direction: column; justify-content: center; padding: 0 40px; transition: 1s ease-in-out; position: absolute; box-sizing: border-box; }
        .hero-banner::after { content: ""; position: absolute; inset: 0; background: rgba(0,0,0,0.4); }
        .hero-content { position: relative; z-index: 2; max-width: 500px; }
        .hero-title { font-size: 28px; font-weight: 800; text-transform: uppercase; margin: 0; line-height: 1.2; }

        /* Search Bar */
        .search-section { padding: 25px 5% 10px; }
        #searchBar { width: 100%; padding: 14px; border-radius: 12px; background: #222; border: 1px solid #333; color: #fff; font-size: 15px; outline: none; }

        /* Anime Grid */
        .section-label { padding: 10px 5%; font-size: 16px; font-weight: 600; color: #bbb; text-transform: uppercase; letter-spacing: 1px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 20px; padding: 0 5%; }
        .card { background: var(--card-bg); border-radius: 15px; overflow: hidden; transition: 0.3s; position: relative; cursor: pointer; border: 1px solid #222; }
        .card:hover { transform: translateY(-5px); border-color: var(--primary); }
        .card img { width: 100%; aspect-ratio: 2/3; object-fit: cover; }
        .card-info { padding: 12px; }
        .card-info h3 { font-size: 13px; margin: 0; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .view-count { font-size: 11px; color: #888; margin-top: 5px; display: flex; align-items: center; gap: 5px; }

        /* Badges */
        .p-badge { position: absolute; top: 10px; right: 10px; background: var(--gold); color: #000; font-size: 10px; font-weight: bold; padding: 3px 8px; border-radius: 5px; z-index: 2; }

        /* Player Overlay */
        #video-overlay { position: fixed; inset: 0; background: #000; z-index: 2000; display: none; flex-direction: column; }
        iframe { width: 100%; height: 60vh; border: none; }
        .close-vid { padding: 15px; background: #e50914; text-align: center; font-weight: bold; cursor: pointer; }

        /* Premium Modal */
        #p-modal { position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 3000; display: none; align-items: center; justify-content: center; padding: 20px; }
        .modal-box { background: #161616; padding: 30px; border-radius: 20px; text-align: center; border: 1px solid var(--gold); max-width: 350px; }
        .modal-box input { width: 100%; padding: 12px; margin: 15px 0; border-radius: 10px; border: 1px solid #333; background: #000; color: #fff; text-align: center; box-sizing: border-box; }
        .tg-btn { width: 100%; padding: 12px; background: #0088cc; color: #fff; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; margin-top: 10px; }
    </style>
</head>
<body>

    <nav>
        <img src="https://i.ibb.co/v4m0f5h/animax-logo-2.png" class="logo-img" onclick="location.reload()">
        <button class="buy-btn" onclick="showModal()">BUY PREMIUM</button>
    </nav>

    <div class="hero-container">
        <div class="hero-banner" id="banner">
            <div class="hero-content">
                <h2 class="hero-title" id="banner-title">Exclusive Adventure</h2>
            </div>
        </div>
    </div>

    <div class="search-section">
        <input type="text" id="searchBar" placeholder="Search Anime..." onkeyup="searchAnime()">
    </div>

    <div class="section-label">Explore Anime</div>
    <div class="grid" id="anime-list">
        </div>

    <div id="video-overlay">
        <div class="close-vid" onclick="closePlayer()">CLOSE PLAYER</div>
        <iframe id="player" src="" allowfullscreen></iframe>
        <div style="padding: 20px;"><h2 id="play-title">Title</h2></div>
    </div>

    <div id="p-modal">
        <div class="modal-box">
            <h2 style="color:var(--gold)">PREMIUM ACCESS</h2>
            <p style="font-size:13px; color:#aaa;">Enter your key to unlock or purchase via Telegram.</p>
            <input type="text" id="key-input" placeholder="ANIMAX-XXXXXX">
            <button class="buy-btn" style="width:100%; padding:12px;" onclick="activateKey()">ACTIVATE KEY</button>
            <button class="tg-btn" onclick="buyKey()">PURCHASE VIA TELEGRAM</button>
            <p style="font-size:11px; margin-top:15px; cursor:pointer;" onclick="hideModal()">Close</p>
        </div>
    </div>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyBcWE5TCxamMSnJxqSm5X4mgSwSccIXcBI",
        authDomain: "myanimeapp-8d079.firebaseapp.com",
        databaseURL: "https://myanimeapp-8d079-default-rtdb.firebaseio.com",
        projectId: "myanimeapp-8d079",
        storageBucket: "myanimeapp-8d079.firebasestorage.app",
        messagingSenderId: "37482342893",
        appId: "1:37482342893:web:bebc7352e4bc102b725fe4"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let isP = localStorage.getItem('isPremium') === 'true';

    // --- Slider ---
    let slides = [], cur = 0;
    db.ref('settings/slider').on('value', snap => {
        slides = snap.val() || [];
        if(slides.length) startSlider();
    });

    function startSlider() {
        const b = slides[cur];
        const banner = document.getElementById('banner');
        banner.style.backgroundImage = `linear-gradient(to right, rgba(0,0,0,0.8), transparent), url('${b.img}')`;
        document.getElementById('banner-title').innerText = b.title;
        cur = (cur + 1) % slides.length;
        setTimeout(startSlider, 5000);
    }

    // --- Load Anime & Search ---
    db.ref('anime').on('value', snap => {
        const list = document.getElementById('anime-list');
        list.innerHTML = "";
        snap.forEach(child => {
            const v = child.val();
            const vKey = child.key;
            list.innerHTML += `
                <div class="card anime-item" data-title="${v.title.toLowerCase()}" onclick="playVideo('${v.url}', '${v.title}', '${v.type}', '${vKey}')">
                    ${v.type === 'premium' ? '<div class="p-badge">PREMIUM</div>' : ''}
                    <img src="${v.thumbnail}">
                    <div class="card-info">
                        <h3>${v.title}</h3>
                        <div class="view-count">üëÅÔ∏è ${(v.views || 0)} Views</div>
                    </div>
                </div>`;
        });
    });

    function searchAnime() {
        let input = document.getElementById('searchBar').value.toLowerCase();
        let items = document.getElementsByClassName('anime-item');
        for (let i = 0; i < items.length; i++) {
            items[i].style.display = items[i].getAttribute('data-title').includes(input) ? "block" : "none";
        }
    }

    // --- Unique View & Player ---
    function playVideo(url, title, type, vKey) {
        if(type === 'premium' && !isP) {
            showModal();
        } else {
            document.getElementById('video-overlay').style.display = 'flex';
            document.getElementById('player').src = url;
            document.getElementById('play-title').innerText = title;

            // ‡¶á‡¶â‡¶®‡¶ø‡¶ï ‡¶≠‡¶ø‡¶â ‡¶≤‡¶ú‡¶ø‡¶ï
            let viewed = JSON.parse(localStorage.getItem('viewed_vids') || "[]");
            if(!viewed.includes(vKey)) {
                db.ref('anime/' + vKey + '/views').transaction(c => (c || 0) + 1);
                viewed.push(vKey);
                localStorage.setItem('viewed_vids', JSON.stringify(viewed));
            }
        }
    }

    function closePlayer() {
        document.getElementById('video-overlay').style.display = 'none';
        document.getElementById('player').src = "";
    }

    // --- Premium & Telegram ---
    function showModal() { document.getElementById('p-modal').style.display = 'flex'; }
    function hideModal() { document.getElementById('p-modal').style.display = 'none'; }

    function activateKey() {
        const k = document.getElementById('key-input').value.trim();
        db.ref('premium_codes/'+k).once('value', snap => {
            if(snap.val() && snap.val().status === 'active') {
                db.ref('premium_codes/'+k).update({status:'used'});
                localStorage.setItem('isPremium', 'true');
                alert("Premium Activated!"); location.reload();
            } else alert("Invalid Key!");
        });
    }

    function buyKey() {
        const userName = "GAMING Rocky"; 
        const userEmail = "freefire368401@gmail.com";
        const msg = `Hello RJ ROCKY,
I want to purchase a 30-Day Premium Key.

User Detail:
Name: ${userName}
Email: ${userEmail}`;
        window.open(`https://t.me/aminezone09?text=${encodeURIComponent(msg)}`, '_blank');
    }
</script>
</body>
        </html>
            
